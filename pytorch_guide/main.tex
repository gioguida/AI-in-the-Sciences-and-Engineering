\documentclass[11pt, a4paper]{article}

% =============================================
% ===    ENCODING AND LANGUAGE SETUP      ===
% =============================================
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}            % A clean, modern font
\usepackage[english]{babel}

% =============================================
% ===         PAGE GEOMETRY               ===
% =============================================
\usepackage{geometry}
\geometry{
    a4paper,
    margin=1.2in,
    bindingoffset=0.5cm,      % Extra space for binding
    headheight=15pt
}

% =============================================
% ===     MATHEMATICAL TYPESETTING        ===
% =============================================
\usepackage{amsmath, amssymb, amsthm, mathtools}
\usepackage{bm}                 % Bold math symbols
\usepackage{dsfont}             % For indicator functions \mathds{1}

% Math operators for neural networks
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator{\softmax}{softmax}
\DeclareMathOperator{\sigmoid}{sigmoid}
\DeclareMathOperator{\ReLU}{ReLU}
\DeclareMathOperator{\GELU}{GELU}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\conv}{conv}
\DeclareMathOperator{\Attention}{Attention}

% Common abbreviations
\newcommand{\E}{\mathbb{E}}      % Expectation
\newcommand{\R}{\mathbb{R}}      % Real numbers
\newcommand{\N}{\mathbb{N}}      % Natural numbers
\newcommand{\Z}{\mathbb{Z}}      % Integers
\newcommand{\C}{\mathbb{C}}      % Complex numbers
\newcommand{\Prob}{\mathbb{P}}   % Probability

% Vector and matrix notation
\newcommand{\vect}[1]{\bm{#1}}
\newcommand{\mat}[1]{\bm{#1}}
\newcommand{\transpose}{^\top}
\newcommand{\inv}{^{-1}}

% Derivatives and gradients
\newcommand{\dd}{\mathrm{d}}
\newcommand{\dderiv}[2]{\frac{\dd #1}{\dd #2}}
\newcommand{\pderiv}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\grad}{\nabla}
\newcommand{\divergence}{\nabla \cdot}
\newcommand{\laplacian}{\nabla^2}

% Loss functions and norms
\newcommand{\loss}{\mathcal{L}}
\newcommand{\norm}[1]{\left\| #1 \right\|}
\newcommand{\abs}[1]{\left| #1 \right|}
\newcommand{\inner}[2]{\left\langle #1, #2 \right\rangle}

% Neural network notation
\newcommand{\weight}{\mat{W}}
\newcommand{\bias}{\vect{b}}
\newcommand{\activation}{\sigma}
\newcommand{\layer}[1]{\vect{h}^{(#1)}}

% =============================================
% ===     GRAPHICS AND FIGURES            ===
% =============================================
\usepackage{graphicx}
\usepackage{float}              % For [H] placement
\usepackage{subcaption}         % For subfigures
\usepackage{wrapfig}            % Text wrapping around figures
\usepackage{tikz}               % For drawing diagrams
\usetikzlibrary{arrows.meta, positioning, shapes.geometric, calc, decorations.pathreplacing}

% Figure path (if using external figures)
% \graphicspath{{./figures/}}

% =============================================
% ===          COLOR DEFINITIONS          ===
% =============================================
\usepackage[dvipsnames, svgnames, table]{xcolor}

% Code highlighting colors
\definecolor{codegray}{gray}{0.95}
\definecolor{codepurple}{rgb}{0.58, 0, 0.82}
\definecolor{codeblue}{rgb}{0, 0, 0.6}
\definecolor{codegreen}{rgb}{0.1, 0.5, 0.1}
\definecolor{codeorange}{rgb}{0.9, 0.4, 0}
\definecolor{codered}{rgb}{0.6, 0, 0}

% Box colors for different environments
\definecolor{noteblue}{RGB}{230, 240, 255}
\definecolor{defgreen}{RGB}{235, 255, 235}
\definecolor{pytorchorange}{RGB}{255, 245, 230}
\definecolor{exercisered}{RGB}{255, 240, 240}
\definecolor{warningyellow}{RGB}{255, 250, 205}
\definecolor{trickpurple}{RGB}{245, 235, 255}
\definecolor{applicationcyan}{RGB}{230, 250, 250}

% =============================================
% ===         HYPERLINKS AND TOC          ===
% =============================================
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue!60!black,
    citecolor=green!50!black,
    urlcolor=blue!60!black,
    pdftitle={Deep Learning Architectures for Scientific Machine Learning},
    pdfauthor={Professor Vectorex Gradiens},
    pdfsubject={Deep Learning, PyTorch, Scientific Computing},
    pdfkeywords={PyTorch, Deep Learning, Scientific ML, Neural Networks},
    bookmarksnumbered=true,
    bookmarksopen=true,
    pdfpagemode=UseOutlines
}

% =============================================
% ===     TYPOGRAPHY AND FORMATTING       ===
% =============================================
\usepackage{microtype}          % Subtle typographical improvements
\usepackage{parskip}            % Cleaner paragraph breaks (no indent)
\usepackage{enumitem}           % Better control over lists
\setlist{nosep, topsep=2pt, partopsep=0pt, parsep=0pt, itemsep=2pt}
\usepackage{booktabs}           % Better tables
\usepackage{array}              % Enhanced table features
\usepackage{multirow}           % Multirow cells in tables
\usepackage{caption}            % Better captions
\captionsetup{
    font=small,
    labelfont=bf,
    format=hang,
    justification=justified
}

% Line spacing
\usepackage{setspace}
\setstretch{0.9}                 % Compact line spacing

% Headers and footers
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE]{\leftmark}
\fancyhead[RO]{\rightmark}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}

% Section styling (article doesn't have chapters)
\usepackage{titlesec}
\titleformat{\section}
    {\normalfont\Large\bfseries\color{blue!60!black}}
    {\thesection}{1em}{}
\titleformat{\subsection}
    {\normalfont\large\bfseries\color{blue!50!black}}
    {\thesubsection}{1em}{}

% =============================================
% ===         CODE LISTINGS               ===
% =============================================
\usepackage{listings}

% Python style
\lstdefinestyle{pythonstyle}{
    language=Python,
    backgroundcolor=\color{codegray},
    commentstyle=\color{codegreen}\itshape,
    keywordstyle=\color{codeblue}\bfseries,
    numberstyle=\tiny\color{gray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\small,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    frame=tb,
    framerule=0.5pt,
    xleftmargin=2em,
    framexleftmargin=1.5em,
    morekeywords={self, True, False, None, with, as},
    % PyTorch-specific keywords
    emphstyle=\color{codeorange}\bfseries,
    emph={torch, nn, functional, optim, autograd, cuda, Tensor, Module, Parameter, DataLoader, Dataset}
}
\lstset{style=pythonstyle}

% Inline code style
\newcommand{\code}[1]{\texttt{\color{codeblue}#1}}
\newcommand{\pythoninline}[1]{\lstinline[language=Python, basicstyle=\ttfamily\small]{#1}}

% =============================================
% ===       COLORED BOXES (TCOLORBOX)     ===
% =============================================
\usepackage[most]{tcolorbox}

% Professor's Note Box
\newtcolorbox{profnote}[1][Professor's Note]{
    colback=noteblue,
    colframe=Blue!60!Black,
    fonttitle=\bfseries,
    title={#1},
    enhanced,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=Blue!60!Black, colframe=Blue!60!Black}
}

% Definition Box
\newtcolorbox{definition}[1][Definition]{
    colback=defgreen,
    colframe=Green!50!Black,
    fonttitle=\bfseries,
    title={#1},
    enhanced,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=Green!50!Black, colframe=Green!50!Black}
}

% PyTorch Command/Idiom Box
\newtcolorbox{pytorchcmd}[1][PyTorch Idiom]{
    colback=pytorchorange,
    colframe=Orange!80!Black,
    fonttitle=\bfseries,
    title={#1},
    enhanced,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=Orange!80!Black, colframe=Orange!80!Black}
}

% Exercise Box
\newtcolorbox{exercise}[1][Exercise]{
    colback=exercisered,
    colframe=Red!70!Black,
    fonttitle=\bfseries,
    title={#1},
    enhanced,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=Red!70!Black, colframe=Red!70!Black},
    breakable
}

% Warning Box
\newtcolorbox{warning}[1][Warning]{
    colback=warningyellow,
    colframe=orange!80!black,
    fonttitle=\bfseries,
    title={#1},
    enhanced,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=orange!80!black, colframe=orange!80!black}
}

% Expert Trick Box
\newtcolorbox{experttrick}[1][Expert Trick]{
    colback=trickpurple,
    colframe=purple!70!black,
    fonttitle=\bfseries,
    title={#1},
    enhanced,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=purple!70!black, colframe=purple!70!black}
}

% Scientific Application Box
\newtcolorbox{application}[1][Scientific Application]{
    colback=applicationcyan,
    colframe=cyan!60!black,
    fonttitle=\bfseries,
    title={#1},
    enhanced,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=cyan!60!black, colframe=cyan!60!black},
    breakable
}

% =============================================
% ===       THEOREM ENVIRONMENTS          ===
% =============================================
\theoremstyle{definition}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}

\theoremstyle{remark}
\newtheorem{remark}{Remark}[section]
\newtheorem{example}{Example}[section]

% =============================================
% ===       ALGORITHM ENVIRONMENT         ===
% =============================================
\usepackage[ruled, vlined, linesnumbered]{algorithm2e}
\SetKwInput{KwInput}{Input}
\SetKwInput{KwOutput}{Output}
\SetKwInput{KwParameters}{Parameters}
\SetKwComment{Comment}{/* }{ */}

% =============================================
% ===     BIBLIOGRAPHY SETUP              ===
% =============================================
\usepackage[
    backend=biber,
    style=numeric,
    sorting=nyt,
    maxbibnames=99
]{biblatex}
% \addbibresource{references.bib}  % Uncomment and add your .bib file

% =============================================
% ===          INDEX SETUP                ===
% =============================================
\usepackage{makeidx}
\makeindex

% =============================================
% ===       CUSTOM COMMANDS               ===
% =============================================

% Difficulty stars for exercises
% \newcommand{\difficulty}[1]{%
%     \ifnum#1=1 $\bigstar$\fi%
%     \ifnum#1=2 $\bigstar\bigstar$\fi%
%     \ifnum#1=3 $\bigstar\bigstar\bigstar$\fi%
%     \ifnum#1=4 $\bigstar\bigstar\bigstar\bigstar$\fi%
%     \ifnum#1=5 $\bigstar\bigstar\bigstar\bigstar\bigstar$\fi%
% }

% Emphasize key concepts
\newcommand{\concept}[1]{\textbf{\color{blue!70!black}#1}}
\newcommand{\pytorch}[1]{\texttt{\color{orange!80!black}#1}}

% Matrix dimensions helper
\newcommand{\matdim}[1]{\text{\scriptsize(#1)}}

% Common neural network layers notation
\newcommand{\Linear}[2]{\text{Linear}(#1 \to #2)}
\newcommand{\Conv}[3]{\text{Conv2d}(#1, #2, k=#3)}
\newcommand{\BatchNorm}[1]{\text{BatchNorm}(#1)}
\newcommand{\LayerNorm}[1]{\text{LayerNorm}(#1)}

% Computational complexity
\newcommand{\bigO}{\mathcal{O}}
\newcommand{\complexity}[1]{\bigO(#1)}

% =============================================
% ===       DOCUMENT METADATA             ===
% =============================================
\title{
    \Huge\bfseries
    Deep Learning Architectures for \\
    Scientific Machine Learning \\[0.5cm]
    \large A Comprehensive PyTorch Guide
}
\author{\large Professor Vectorex Gradiens}
\date{\today \\ \vspace{0.5cm} \small Version 1.0}

% =============================================
% ===       PDF METADATA                  ===
% =============================================
\usepackage{datetime}
\newdateformat{mydate}{\THEDAY\ \monthname[\THEMONTH] \THEYEAR}

% =============================================
% ===    ADDITIONAL USEFUL PACKAGES       ===
% =============================================
\usepackage{lipsum}             % For placeholder text (remove in final)
\usepackage{todonotes}          % For TODO notes (remove in final)

% =============================================
% ===          DOCUMENT BEGINS            ===
% =============================================
\begin{document}

% =============================================
% ===          FRONT MATTER               ===
% =============================================

% --- Title Page ---
\maketitle
\thispagestyle{empty}

\clearpage

% --- Copyright and Disclaimer ---
\thispagestyle{empty}
\vspace*{\fill}
\begin{center}
\textbf{Disclaimer}
\end{center}

\textbf{Important Notice:} Apart from this paragraph, every single word in this document was written with the assistance of Large Language Models. This document is intended as an aid for learning PyTorch, in particular for implementing deep learning architectures presented in the course "AI in the Sciences and Engineering" held at ETH Zürich.

The content is extremely likely to contain errors, so use it with care, knowing that this isn't reviewed or approved by domain experts. Always verify critical implementations and consult primary sources for production use.

\textit{Giovanni Guidarini, December 2025}

\vspace{1cm}

\textbf{License:} This work is shared for educational purposes. PyTorch is developed by Meta AI and is licensed under the BSD-style license. All code examples are provided as-is without warranty.

\vspace{1cm}

\textbf{Acknowledgments:} This textbook builds upon the collective wisdom of the PyTorch community, scientific machine learning researchers, and educators worldwide. Special thanks to the developers of PyTorch, the authors of foundational papers in deep learning, and students whose questions shaped this material.

\vspace*{\fill}
\clearpage

% --- Dedication (optional) ---
% \thispagestyle{empty}
% \vspace*{\fill}
% \begin{center}
% \textit{To all scientists and engineers venturing into the realm of deep learning—\\
% may you find clarity in complexity and beauty in gradients.}
% \end{center}
% \vspace*{\fill}
\clearpage

% --- Preface ---
\section*{Preface}
\addcontentsline{toc}{section}{Preface}

My dear student,

Welcome. It is a distinct pleasure to guide you on this journey. You are already embedded in the world of scientific computing, a field of precision, rigor, and computational elegance. You will find that deep learning is not so different. At its heart, it is a powerful form of high-dimensional function approximation, built on the familiar foundations of linear algebra and calculus. The "magic" is simply that we have found a way to make these function approximators (\textit{neural networks}) trainable on a massive scale.

Your lack of PyTorch experience is not a hindrance; it is an opportunity. You arrive with no bad habits. We will build your knowledge from the ground up, with the same care one takes in formulating a proof or designing a robust simulation. PyTorch is our "language" for this. It is expressive, powerful, and, once you are fluent, a genuine joy to use.

This textbook is comprehensive, spanning from the fundamental \pytorch{torch.Tensor} to state-of-the-art architectures like Transformers and Neural Operators. Each chapter builds systematically, combining rigorous theory with practical implementation. You will not merely learn to use PyTorch—you will understand \textit{why} it works the way it does, and you will develop the intuition to design your own architectures for scientific problems.

\textbf{How to Use This Book:}
\begin{itemize}
    \item \textbf{Theory sections} provide mathematical foundations and intuition. Do not skip these—they are the bedrock upon which everything rests.
    \item \textbf{Implementation sections} show you the "PyTorch way"—idioms, best practices, and common pitfalls. Type out the code yourself; reading is not enough.
    \item \textbf{Exercises} range from elementary to research-level. Attempt all of them. Struggle is where learning happens.
    \item \textbf{Colored boxes} highlight key insights:
    \begin{itemize}
        \item Professor's Notes for expert intuition
        \item PyTorch Idioms for best practices
        \item Warnings for common mistakes
        \item Expert Tricks for advanced techniques
        \item Scientific Applications showing real-world use
    \end{itemize}
\end{itemize}

Treat this not just as a technical exercise, but as an art. The code we write, like the \LaTeX{} that renders this page, can and should be clean, precise, and beautiful.

Let us begin.

\vspace{1cm}
\begin{flushright}
Professor Vectorex Gradiens \\
\textit{ETH Zürich} \\
December 2025
\end{flushright}

\clearpage

% --- Table of Contents ---
\tableofcontents
\clearpage

% --- List of Figures (optional) ---
% \listoffigures
% \clearpage

% --- List of Tables (optional) ---
% \listoftables
% \clearpage

% =============================================
% ===          MAIN MATTER                ===
% =============================================

% =============================================
% === PART I: FOUNDATIONS                 ===
% =============================================
\part{Foundations of PyTorch}
\label{part:foundations}

% Chapter 1 will begin here
\input{chapters/chapter01}
\input{chapters/chapter02}
\input{chapters/chapter03}
\input{chapters/chapter04}
\input{chapters/chapter05}
\input{chapters/chapter06}
\input{chapters/chapter07}
\input{chapters/chapter08}
\input{chapters/chapter09}
\input{chapters/chapter10}
\input{chapters/chapter11}
\input{chapters/chapter13}
\input{chapters/chapter14}
\input{chapters/chapter15}
\input{chapters/chapter16}

% \input{chapters/chapter05_to_end}


\appendix
% \input{appendices/appendixA_math_prerequisites}
% \input{appendices/appendixB_pytorch_setup}
% \input{appendices/appendixC_solutions}
% \input{appendices/appendixD_quick_reference}
% \input{appendices/appendixE_resources}

\end{document}